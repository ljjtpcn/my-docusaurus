---
slug: acm-geometry
title: 计算几何
date: 2022-06-30
authors: ljj
tags: [计算几何, ACM]
---
<!-- truncate -->

## 二维凸包

### 模板（更新中）

```cpp
struct Point {
    double x;
    double y;
};

Point operator-(const Point a, Point b) { return {a.x - b.x, a.y - b.y}; }

double cross(Point a, Point b) { return a.x * b.y - b.x * a.y; }

double area(Point x, Point a, Point b) { return cross(a - x, b - x); };

bool cmp(Point a, Point b) {
    if (a.x != b.x) return a.x < b.x;
    return a.y < b.y;
}

Point rotate(Point p, double angle) {
    return {p.x * cos(angle) + p.y * sin(angle),
            p.y * cos(angle) - p.x * sin(angle)};
}

double getDist(Point a, Point b) {
    return sqrt((b.x - a.x) * (b.x - a.x) + (b.y - a.y) * (b.y - a.y));
}
```

###  [圈奶牛Fencing the Cows](https://www.luogu.com.cn/problem/P2742)

```cpp
// Problem: P2742 [USACO5.1]圈奶牛Fencing the Cows /【模板】二维凸包
// Contest: Luogu
// URL: https://www.luogu.com.cn/problem/P2742
// Memory Limit: 128 MB
// Time Limit: 1000 ms
// Powered by CP Editor (https://cpeditor.org)
#include <bits/stdc++.h>
#define Please return
#define AC 0
#define pb push_back
#define fir first
#define sec second
#define inf 0x3f3f3f3f
#define INF 0x3f3f3f3f3f3f3f3f
using namespace std;
// clang-format off
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int, int> pii;
typedef pair<ll, ll> pll;
inline void read(int &num) {int s = 0;char ch = getchar();while (ch < '0' || ch > '9') ch = getchar();while (ch >= '0' && ch <= '9')s = (s << 3) + (s << 1) + ch - '0', ch = getchar();num = s;}
inline void read(ll &num) {ll s = 0;char ch = getchar();while (ch < '0' || ch > '9') ch = getchar();while (ch >= '0' && ch <= '9')s = (s << 3) + (s << 1) + ch - '0', ch = getchar();num = s;}
ll ksm(ll a, ll b){ll res = 1;while(b){if(b & 1)res *= a;a *= a;b >>= 1;}return res;}
ll ksm(ll a, ll b, int mod){ll res = 1;while(b){if(b & 1)res = res * a % mod;a = a * a % mod;b >>= 1;}return res;}
struct node { int x, y, cnt; };
struct cmp {bool operator()(node a, node b) { return a.cnt > b.cnt; }};
// clang-format on
const int mod = 1e9 + 7;
const int N = 1e6 + 10;

struct Point {
    double x;
    double y;
};
Point p[N];
Point st[N];
void solve() {
    int n;
    cin >> n;
    if (n < 3) {
        cout << 0.00;
        return;
    }

    for (int i = 1; i <= n; i++) {
        cin >> p[i].x >> p[i].y;
    }
    sort(p + 1, p + n + 1, [&](Point a, Point b) {
        if (a.x != b.x)
            return a.x < b.x;
        else
            return a.y < b.y;
    });

    auto check = [&](Point x, Point a, Point b) {
        Point x1 = {a.x - x.x, a.y - x.y};
        Point x2 = {b.x - x.x, b.y - x.y};
        return x1.x * x2.y - x2.x * x1.y;
    };

    st[0] = p[1], st[1] = p[2];
    int top = 1;
    for (int i = 3; i <= n; i++) {
        while (top && check(st[top - 1], st[top], p[i]) <= 0) top--;
        st[++top] = p[i];
    }

    st[++top] = p[n - 1];
    for (int i = n - 2; i >= 1; i--) {
        while (top && check(st[top - 1], st[top], p[i]) <= 0) top--;
        st[++top] = p[i];
    }

    double ans = 0;
    for (int i = 0; i <= top - 1; i++) {
        Point a = st[i], b = st[i + 1];
        ans += sqrt((b.x - a.x) * (b.x - a.x) + (b.y - a.y) * (b.y - a.y));
    }
    cout << fixed << setprecision(2) << ans;
}

int main() {
    int __ = 1;
    // scanf("%d", &__);
    while (__--) {
        solve();
    }
    Please AC;
}

```



###  [信用卡凸包](https://www.luogu.com.cn/problem/P3829)
```cpp
// Problem: P3829 [SHOI2012]信用卡凸包
// Contest: Luogu
// URL: https://www.luogu.com.cn/problem/P3829
// Memory Limit: 125 MB
// Time Limit: 1000 ms
// Powered by CP Editor (https://cpeditor.org)
#include <bits/stdc++.h>
#define Please return
#define AC 0
#define pb push_back
#define fir first
#define sec second
#define inf 0x3f3f3f3f
#define INF 0x3f3f3f3f3f3f3f3f
using namespace std;
// clang-format off
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int, int> pii;
typedef pair<ll, ll> pll;
inline void read(int &num) {int s = 0;char ch = getchar();while (ch < '0' || ch > '9') ch = getchar();while (ch >= '0' && ch <= '9')s = (s << 3) + (s << 1) + ch - '0', ch = getchar();num = s;}
inline void read(ll &num) {ll s = 0;char ch = getchar();while (ch < '0' || ch > '9') ch = getchar();while (ch >= '0' && ch <= '9')s = (s << 3) + (s << 1) + ch - '0', ch = getchar();num = s;}
ll ksm(ll a, ll b){ll res = 1;while(b){if(b & 1)res *= a;a *= a;b >>= 1;}return res;}
ll ksm(ll a, ll b, int mod){ll res = 1;while(b){if(b & 1)res = res * a % mod;a = a * a % mod;b >>= 1;}return res;}
struct node { int x, y, cnt; };
struct cmp {bool operator()(node a, node b) { return a.cnt > b.cnt; }};
// clang-format on
const int mod = 1e9 + 7;
const int N = 2e5 + 10;

struct Point {
    double x;
    double y;
};

Point operator-(const Point a, Point b) { return {a.x - b.x, a.y - b.y}; }

double cross(Point a, Point b) { return a.x * b.y - b.x * a.y; }

double area(Point x, Point a, Point b) { return cross(a - x, b - x); };

bool cmp(Point a, Point b) {
    if (a.x != b.x) return a.x < b.x;
    return a.y < b.y;
}

Point rotate(Point p, double angle) {
    return {p.x * cos(angle) + p.y * sin(angle),
            p.y * cos(angle) - p.x * sin(angle)};
}

double getDist(Point a, Point b) {
    return sqrt((b.x - a.x) * (b.x - a.x) + (b.y - a.y) * (b.y - a.y));
}

Point p[N];
Point st[N];
vector<Point> arr;
void solve() {
    int n;
    cin >> n;

    double a, b, r;
    cin >> b >> a >> r;
    a = a / 2 - r, b = b / 2 - r;
    int dx[] = {1, 1, -1, -1}, dy[] = {1, -1, -1, 1};
    while (n--) {
        double x, y, angle;
        cin >> x >> y >> angle;
        for (int i = 0; i < 4; i++) {
            auto t = rotate({dx[i] * a, dy[i] * b}, -angle);
            arr.pb({x + t.x, y + t.y});
        }
    }
    sort(arr.begin(), arr.end(), cmp);

    st[0] = arr[0], st[1] = arr[1];
    int top = 1;
    for (int i = 2; i < arr.size(); i++) {
        while (top && area(st[top - 1], st[top], arr[i]) <= 0) top--;
        st[++top] = arr[i];
    }

    st[++top] = arr[arr.size() - 2];
    for (int i = arr.size() - 3; i >= 0; i--) {
        while (top && area(st[top - 1], st[top], arr[i]) <= 0) top--;
        st[++top] = arr[i];
    }

    double ans = 0;
    // 最后会多存一个起点P1， 所以top - 1；
    for (int i = 0; i <= top - 1; i++) {
        // cout << ans << "?  ";
        Point a = st[i], b = st[i + 1];
        ans += getDist(a, b);
        // cout << i + 1 << ": " << a.x << ", " << a.y << endl;
    }
    ans += 2 * 3.141592653589793 * r;
    cout << fixed << setprecision(2) << ans;
}

int main() {
    int __ = 1;
    // scanf("%d", &__);
    while (__--) {
        solve();
    }
    Please AC;
}

////////////////////////////////////////////////////////////////////
//                          _ooOoo_                               //
//                         o8888888o                              //
//                         88" . "88                              //
//                         (| ^_^ |)                              //
//                         O\  =  /O                              //
//                      ____/`---'\____                           //
//                    .'  \\|     |//  `.                         //
//                   /  \\|||  :  |||//  \                        //
//                  /  _||||| -:- |||||-  \                       //
//                  |   | \\\  -  /// |   |                       //
//                  | \_|  ''\---/''  |   |                       //
//                  \  .-\__  `-`  ___/-. /                       //
//                ___`. .'  /--.--\  `. . ___                     //
//              ."" '<  `.___\_<|>_/___.'  >'"".                  //
//            | | :  `- \`.;`\ _ /`;.`/ - ` : | |                 //
//            \  \ `-.   \_ __\ /__ _/   .-` /  /                 //
//      ========`-.____`-.___\_____/___.-`____.-'========         //
//                           `=---='                              //
//      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^        //
//             佛祖保佑       永不WA       永无BUG                 //
////////////////////////////////////////////////////////////////////
```
